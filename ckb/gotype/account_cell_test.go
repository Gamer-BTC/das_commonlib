package gotype

import (
	"encoding/hex"
	"fmt"
	"github.com/DeAccountSystems/das_commonlib/ckb/celltype"
	"testing"
)

/**
 * Copyright (C), 2019-2021
 * FileName: account_cell_test
 * Author:   LinGuanHong
 * Date:     2021/6/25 4:02
 * Description:
 */

func Test_ParseWitnessToAccountCell(t *testing.T) {
	hexStr := "0x64617301000000ce02000010000000100000006f0100005f010000100000001400000018000000010000000100000043010000430100001c000000300000002e010000360100003e0100003f01000006980d3ab90a0c42285eb056016037738bb6a86ffe0000002c00000041000000560000006b0000008000000095000000aa000000bf000000d4000000e9000000150000000c00000010000000020000000100000074150000000c00000010000000020000000100000072150000000c00000010000000020000000100000079150000000c0000001000000002000000010000006e150000000c00000010000000020000000100000064150000000c00000010000000020000000100000061150000000c0000001000000002000000010000006d150000000c00000010000000020000000100000065150000000c00000010000000020000000100000072150000000c000000100000000200000001000000655418c46000000000000000000000000000040000005f010000100000001400000018000000000000000100000043010000430100001c000000300000002e010000360100003e0100003f01000006980d3ab90a0c42285eb056016037738bb6a86ffe0000002c00000041000000560000006b0000008000000095000000aa000000bf000000d4000000e9000000150000000c00000010000000020000000100000074150000000c00000010000000020000000100000072150000000c00000010000000020000000100000079150000000c0000001000000002000000010000006e150000000c00000010000000020000000100000064150000000c00000010000000020000000100000061150000000c0000001000000002000000010000006d150000000c00000010000000020000000100000065150000000c00000010000000020000000100000072150000000c000000100000000200000001000000655418c4600000000000000000000000000004000000"
	hexStr = hexStr[2:]
	bys,err := hex.DecodeString(hexStr)
	if err != nil {
		fmt.Println(err.Error())
		return
	}
	accountCell := AccountCell{WitnessData: bys}
	accountCellDataNew,err := accountCell.GetNewAccountCellData()
	if err != nil {
		fmt.Println(err.Error())
	} else {
		fmt.Println(accountCellDataNew.CellData.Len(),celltype.IsVersion2AccountCell(accountCellDataNew.CellData))
	}
	accountCellDataOld,err := accountCell.GetOldAccountCellData()
	if err != nil {
		fmt.Println(err.Error())
	} else {
		fmt.Println(accountCellDataOld.CellData.Len(),celltype.IsVersion2AccountCell(accountCellDataOld.CellData))
	}
}


